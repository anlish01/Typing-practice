<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°å­¦ç”Ÿé”®ç›˜æŒ‡æ³•ç»ƒä¹ </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 25px;
            max-width: 750px;
            width: 100%;
            text-align: center;
        }

        h1 {
            color: #5a67d8;
            font-size: 2.2em;
            margin-bottom: 15px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }

        .game-area {
            margin: 30px 0;
        }

        .target-key {
            font-size: 2.8em;
            color: #e53e3e;
            font-weight: bold;
            margin: 15px 0;
            padding: 20px 40px;
            border: 3px solid #e53e3e;
            border-radius: 15px;
            background: linear-gradient(135deg, #fff5f5, #fed7d7);
            display: inline-block;
            min-width: 120px;
            animation: pulse 2s infinite;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .target-key:hover {
            background: linear-gradient(135deg, #fed7d7, #feb2b2);
            transform: scale(1.05);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .keyboard {
            background: #f7fafc;
            border-radius: 10px;
            padding: 10px;
            margin: 15px 0;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .keyboard-row {
            display: flex;
            justify-content: center;
            margin: 4px 0;
            gap: 3px;
        }

        .key {
            background: #e2e8f0;
            border: none;
            border-radius: 8px;
            padding: 12px 14px;
            font-size: 1.1em;
            font-weight: bold;
            color: #2d3748;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            min-width: 45px;
            position: relative;
        }

        .key:hover {
            background: #cbd5e0;
            transform: translateY(-2px);
        }

        .key.active {
            background: #4299e1;
            color: white;
            transform: translateY(2px);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .key.target {
            background: #ffd700;
            color: #2d3748;
            animation: targetPulse 1s infinite;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.6);
        }

        @keyframes targetPulse {
            0% { 
                background: #ffd700;
                transform: scale(1);
            }
            50% { 
                background: #ffed4e;
                transform: scale(1.1);
            }
            100% { 
                background: #ffd700;
                transform: scale(1);
            }
        }

        .key.correct {
            background: #48bb78;
            color: white;
            animation: correctPop 0.5s ease;
        }

        @keyframes correctPop {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .key.wrong {
            background: #f56565;
            color: white;
            animation: shake 0.5s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .space-key {
            min-width: 200px;
            background: #a0aec0;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
            gap: 10px;
        }

        .stat-box {
            background: #edf2f7;
            padding: 10px;
            border-radius: 10px;
            flex: 1;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .stat-number {
            font-size: 1.8em;
            font-weight: bold;
            color: #5a67d8;
        }

        .controls {
            margin: 10px 0;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 5px;
        }

        .btn {
            background: #5a67d8;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 1.1em;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            min-width: 60px;
        }

        .btn:hover {
            background: #4c51bf;
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }

        .btn:active, .btn.active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            background: #38a169;
        }



        .mode-selector {
            margin: 10px 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 5px;
        }

        .mode-btn {
            background: #ed8936;
            padding: 8px 16px;
            font-size: 1em;
            margin: 0;
        }

        .mode-btn.active {
            background: #38a169;
        }



        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 10px;
            }

            h1 {
                font-size: 2em;
            }

            .key {
                padding: 10px 12px;
                font-size: 1em;
                min-width: 35px;
            }

            .space-key {
                min-width: 200px;
            }

            .stats {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ® å°å­¦ç”Ÿé”®ç›˜æŒ‡æ³•ç»ƒä¹ </h1>

        <div class="mode-selector">
            <button class="btn mode-btn active" data-mode="basic">åŸºç¡€ç»ƒä¹ </button>
            <button class="btn mode-btn" data-mode="left">å·¦æ‰‹ç»ƒä¹ </button>
            <button class="btn mode-btn" data-mode="right">å³æ‰‹ç»ƒä¹ </button>
            <button class="btn mode-btn" data-mode="numbers">æ•°å­—ç»ƒä¹ </button>
            <button class="btn mode-btn" data-mode="symbols">ç¬¦å·ç»ƒä¹ </button>
            <button class="btn mode-btn" data-mode="words">å•è¯ç»ƒä¹ </button>
            <button class="btn mode-btn" data-mode="sentences">å¥å­ç»ƒä¹ </button>
            <button class="btn mode-btn" data-mode="zuowen">ä½œæ–‡è¯­å¥</button>
        </div>

        <div class="game-area">
            <div class="target-key" id="targetKey" onclick="typingGame.startGame()">æŒ‰<å¼€å§‹ç»ƒä¹ >å¼€å§‹</div>
        </div>

        <div class="keyboard">
            <!-- æ•°å­—è¡Œ - åŒ…å«ç¬¦å· -->
            <div class="keyboard-row">
                <button class="key" data-key="`">`</button>
                <button class="key" data-key="1">1<br><span style="font-size: 0.7em;">!</span></button>
                <button class="key" data-key="2">2<br><span style="font-size: 0.7em;">@</span></button>
                <button class="key" data-key="3">3<br><span style="font-size: 0.7em;">#</span></button>
                <button class="key" data-key="4">4<br><span style="font-size: 0.7em;">$</span></button>
                <button class="key" data-key="5">5<br><span style="font-size: 0.7em;">%</span></button>
                <button class="key" data-key="6">6<br><span style="font-size: 0.7em;">^</span></button>
                <button class="key" data-key="7">7<br><span style="font-size: 0.7em;">&</span></button>
                <button class="key" data-key="8">8<br><span style="font-size: 0.7em;">*</span></button>
                <button class="key" data-key="9">9<br><span style="font-size: 0.7em;">(</span></button>
                <button class="key" data-key="0">0<br><span style="font-size: 0.7em;">)</span></button>
                <button class="key" data-key="-">-<br><span style="font-size: 0.7em;">_</span></button>
                <button class="key" data-key="=">=<br><span style="font-size: 0.7em;">+</span></button>
                <button class="key" data-key="backspace" style="min-width: 80px;">é€€æ ¼</button>
            </div>
            
            <!-- å­—æ¯è¡Œ1 -->
            <div class="keyboard-row">
                <button class="key" data-key="tab" style="min-width: 60px;">Tab</button>
                <button class="key" data-key="q">Q</button>
                <button class="key" data-key="w">W</button>
                <button class="key" data-key="e">E</button>
                <button class="key" data-key="r">R</button>
                <button class="key" data-key="t">T</button>
                <button class="key" data-key="y">Y</button>
                <button class="key" data-key="u">U</button>
                <button class="key" data-key="i">I</button>
                <button class="key" data-key="o">O</button>
                <button class="key" data-key="p">P</button>
                <button class="key" data-key="[">[<br><span style="font-size: 0.7em;">{</span></button>
                <button class="key" data-key="]">]<br><span style="font-size: 0.7em;">}</span></button>
                <button class="key" data-key="backslash">\\<br><span style="font-size: 0.7em;">|</span></button>
            </div>
            
            <!-- å­—æ¯è¡Œ2 -->
            <div class="keyboard-row">
                <button class="key" data-key="caps" style="min-width: 70px;">Caps</button>
                <button class="key" data-key="a">A</button>
                <button class="key" data-key="s">S</button>
                <button class="key" data-key="d">D</button>
                <button class="key" data-key="f">F</button>
                <button class="key" data-key="g">G</button>
                <button class="key" data-key="h">H</button>
                <button class="key" data-key="j">J</button>
                <button class="key" data-key="k">K</button>
                <button class="key" data-key="l">L</button>
                <button class="key" data-key=";">;<br><span style="font-size: 0.7em;">:</span></button>
                <button class="key" data-key="'">'<br><span style="font-size: 0.7em;">"</span></button>
                <button class="key" data-key="enter" style="min-width: 80px;">Enter</button>
            </div>
            
            <!-- å­—æ¯è¡Œ3 -->
            <div class="keyboard-row">
                <button class="key" data-key="shift" style="min-width: 90px;">Shift</button>
                <button class="key" data-key="z">Z</button>
                <button class="key" data-key="x">X</button>
                <button class="key" data-key="c">C</button>
                <button class="key" data-key="v">V</button>
                <button class="key" data-key="b">B</button>
                <button class="key" data-key="n">N</button>
                <button class="key" data-key="m">M</button>
                <button class="key" data-key=",">,<br><span style="font-size: 0.7em;">&lt;</span></button>
                <button class="key" data-key=".">.<br><span style="font-size: 0.7em;">&gt;</span></button>
                <button class="key" data-key="/">/<br><span style="font-size: 0.7em;">?</span></button>
                <button class="key" data-key="shift2" style="min-width: 90px;">Shift</button>
            </div>
            
            <!-- ç©ºæ ¼è¡Œ -->
            <div class="keyboard-row">
                <button class="key" data-key="ctrl" style="min-width: 60px;">Ctrl</button>
                <button class="key" data-key="win" style="min-width: 50px;">Win</button>
                <button class="key" data-key="alt" style="min-width: 50px;">Alt</button>
                <button class="key space-key" data-key=" ">ç©ºæ ¼é”®</button>
                <button class="key" data-key="alt2" style="min-width: 50px;">Alt</button>
                <button class="key" data-key="win2" style="min-width: 50px;">Win</button>
                <button class="key" data-key="ctrl2" style="min-width: 60px;">Ctrl</button>
            </div>
        </div>

        <div class="stats">
            <div class="stat-box">
                <div>å‡†ç¡®ç‡</div>
                <div class="stat-number" id="accuracy">0%</div>
            </div>
            <div class="stat-box">
                <div>æ­£ç¡®æŒ‰é”®</div>
                <div class="stat-number" id="correct">0</div>
            </div>
            <div class="stat-box">
                <div>æ€»æŒ‰é”®</div>
                <div class="stat-number" id="total">0</div>
            </div>
        </div>

        <div class="controls">
            <button class="btn" id="startBtn">å¼€å§‹ç»ƒä¹ </button>
            <button class="btn" id="resetBtn">é‡ç½®</button>
            <button class="btn" id="slowBtn">æ…¢é€Ÿ</button>
            <button class="btn active" id="normalBtn">ä¸­é€Ÿ</button>
            <button class="btn" id="fastBtn">å¿«é€Ÿ</button>
        </div>


    </div>

    <script>
        // å®Œæ•´çš„æ±‰å­—è½¬æ‹¼éŸ³æ˜ å°„è¡¨
        const pinyinMap = {
            'æˆ‘': 'wo', 'çˆ±': 'ai', 'çš„': 'de', 'å®¶': 'jia',
            'ä»Š': 'jin', 'å¤©': 'tian', 'æ°”': 'qi', 'å¾ˆ': 'hen', 'å¥½': 'hao',
            'å’Œ': 'he', 'å°': 'xiao', 'æœ‹': 'peng', 'å‹': 'you', 'ä¸€': 'yi', 'èµ·': 'qi', 'ç©': 'wan',
            'å–œ': 'xi', 'æ¬¢': 'huan', 'åƒ': 'chi', 'è‹¹': 'ping', 'æœ': 'guo',
            'å¦ˆ': 'ma', 'å¯¹': 'dui', 'å­¦': 'xue', 'æ ¡': 'xiao', 'é‡Œ': 'li', 'æœ‰': 'you', 'å¤š': 'duo', 'ä¹¦': 'shu',
            'è€': 'lao', 'å¸ˆ': 'shi', 'æ•™': 'jiao', 'ä»¬': 'men', 'ä¹ ': 'xi',
            'ä¸ª': 'ge', 'å¦¹': 'mei', 'å¦¹': 'mei',
            'çˆ¸': 'ba', 'å¸¦': 'dai', 'å»': 'qu', 'å…¬': 'gong', 'å›­': 'yuan',
            'ç”»': 'hua', 'ä¸Š': 'shang', 'ç™½': 'bai', 'äº‘': 'yun',
            'é¸Ÿ': 'niao', 'åœ¨': 'zai', 'é£': 'fei',
            'èŠ±': 'hua', 'å„¿': 'er', 'å¼€': 'kai', 'äº†': 'le', 'ç¾': 'mei', 'ä¸½': 'li',
            'è‰': 'cao', 'ç»¿': 'lv',
            'å¿«': 'kuai', 'ä¹': 'le',
            'æ–°': 'xin', 'ä¹¦': 'shu', 'åŒ…': 'bao',
            'å¼€': 'kai', 'å¿ƒ': 'xin',
            'åŒ': 'tong', 'ä¸Š': 'shang', 'å­¦': 'xue',
            'å†°': 'bing', 'æ·‡': 'qi', 'æ·‹': 'lin',
            'çˆ·': 'ye', 'çˆ·': 'ye', 'è®²': 'jiang', 'æ•…': 'gu', 'äº‹': 'shi', 'ç»™': 'gei', 'å¬': 'ting',
            'å¥¶': 'nai', 'å¥¶': 'nai', 'åš': 'zuo', 'å¥½': 'hao', 'é¥­': 'fan', 'èœ': 'cai',
            'ç‹—': 'gou', 'å¯': 'ke', 'çˆ±': 'ai',
            'ä¹°': 'mai', 'è¡£': 'yi', 'æœ': 'fu',
            'å®¶': 'jia', 'é‡Œ': 'li', 'çœ‹': 'kan', 'ä¹¦': 'shu',
            'å¸®': 'bang', 'æ‰«': 'sao', 'åœ°': 'di',
            'éª‘': 'qi', 'è‡ª': 'zi', 'è¡Œ': 'xing', 'è½¦': 'che',
            'å…·': 'ju',
            'èŠ±': 'hua', 'å›­': 'yuan', 'æ¼‚': 'piao', 'äº®': 'liang',
            'è¯­': 'yu', 'æ–‡': 'wen', 'è¯¾': 'ke',
            // æ–°å¢æ±‰å­—æ‹¼éŸ³
            'æ˜¥': 'chun', 'å¤': 'xia', 'ç§‹': 'qiu', 'å†¬': 'dong',
            'æ ‘': 'shu', 'å¶': 'ye', 'å˜': 'bian', 'é»„': 'huang',
            'é›ª': 'xue', 'çœŸ': 'zhen', 'å­¦': 'xue', 'ä¼š': 'hui', 'å­—': 'zi',
            'æ•°': 'shu', 'å¾—': 'de', 'åˆ†': 'fen', 'æ¡Œ': 'zhuo',
            'è·¯': 'lu', 'ä¹°': 'mai', 'é“…': 'qian', 'ç¬”': 'bi',
            'é•¿': 'zhang', 'å¤§': 'da', 'å½“': 'dang', 'ç§‘': 'ke', 'å­¦': 'xue', 'å®¶': 'jia',
            'åŠ©': 'zhu', 'äºº': 'ren', 'å¿«': 'kuai', 'ä¹': 'le'
        };

        // æ±‰å­—è½¬æ‹¼éŸ³å‡½æ•°
            function chineseToPinyin(text) {
                return text.split('').map(char => pinyinMap[char] || char).join('');
            }

            // è·å–æ•´ä¸ªå¥å­çš„æ‹¼éŸ³
            function getFullPinyin(text) {
                return text.split('').map(char => pinyinMap[char] || char).join('');
            }

        class KeyboardGame {
            constructor() {
                this.currentKey = '';
                this.isPlaying = false;
                this.correctCount = 0;
                this.totalCount = 0;
                this.currentMode = 'basic';
                
                this.modes = {
                basic: {
                    keys: ['q', 'w', 'e', 'r', 't', 'y', 'u', 'i', 'o', 'p', 'a', 's', 'd', 'f', 'g', 'h', 'j', 'k', 'l', 'z', 'x', 'c', 'v', 'b', 'n', 'm'],
                    name: 'åŸºç¡€ç»ƒä¹ '
                },
                left: {
                    keys: ['q', 'w', 'e', 'r', 't', 'a', 's', 'd', 'f', 'g', 'z', 'x', 'c', 'v', 'b'],
                    name: 'å·¦æ‰‹ç»ƒä¹ '
                },
                right: {
                    keys: ['y', 'u', 'i', 'o', 'p', 'h', 'j', 'k', 'l', 'n', 'm'],
                    name: 'å³æ‰‹ç»ƒä¹ '
                },
                numbers: {
                    keys: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '0'],
                    name: 'æ•°å­—ç»ƒä¹ '
                },
                symbols: {
                    keys: ['-', '=', '[', ']', ';', "'", ',', '.', '/', '1', '2', '3', '4', '5', '6', '7', '8', '9', '0'],
                    name: 'ç¬¦å·ç»ƒä¹ '
                },
                words: {
                    name: 'å•è¯ç»ƒä¹ ',
                    content: [
                        // åŸºç¡€åŠ¨ç‰©
                        'cat', 'dog', 'bird', 'fish', 'duck', 'frog', 'bear', 'lion', 'tiger', 'rabbit',
                        // æ—¥å¸¸ç‰©å“
                        'book', 'pen', 'desk', 'chair', 'bag', 'cup', 'ball', 'toy', 'shoe', 'hat',
                        // è‡ªç„¶ç°è±¡
                        'sun', 'moon', 'star', 'tree', 'flower', 'grass', 'sky', 'cloud', 'rain', 'snow',
                        // åŠ¨ä½œè¯æ±‡
                        'run', 'jump', 'walk', 'swim', 'sing', 'dance', 'read', 'write', 'play', 'eat',
                        // äººç‰©ç§°å‘¼
                        'mom', 'dad', 'teacher', 'friend', 'baby', 'girl', 'boy', 'sister', 'brother', 'family'
                    ]
                },
                sentences: {
                    name: 'å¥å­ç»ƒä¹ ',
                    content: [
                        // åŸæœ‰å¥å­
                        'I love my cat.', 'The sun is bright.', 'I can run fast.', 'This is fun!', 'I have a book.',
                        // æ–°å¢20å¥
                        // å®¶åº­ä¸»é¢˜
                        'My mom is very kind.', 'I love my family.', 'Dad reads me stories.', 'My sister is my friend.',
                        // å­¦æ ¡ç”Ÿæ´»
                        'I go to school every day.', 'My teacher is nice.', 'I like my classmates.', 'We play at recess.',
                        // æ—¥å¸¸æ´»åŠ¨
                        'I eat breakfast at home.', 'I brush my teeth daily.', 'I help my mom cook.', 'I walk to school.',
                        // å…´è¶£çˆ±å¥½
                        'I love drawing pictures.', 'Reading books is fun.', 'I can sing songs.', 'Dancing makes me happy.',
                        // è‡ªç„¶å¤©æ°”
                        'The sky is blue today.', 'It is raining now.', 'I see a rainbow.', 'The flowers are beautiful.', 'Birds can fly high.'
                    ]
                },
                zuowen: {
                    name: 'ä½œæ–‡è¯­å¥',
                    content: [
                        // åŸæœ‰30å¥
                        'æˆ‘çˆ±æˆ‘çš„å®¶',
                        'ä»Šå¤©å¤©æ°”å¾ˆå¥½',
                        'æˆ‘å’Œå°æœ‹å‹ä¸€èµ·ç©',
                        'æˆ‘å–œæ¬¢åƒè‹¹æœ',
                        'å¦ˆå¦ˆå¯¹æˆ‘å¾ˆå¥½',
                        'å­¦æ ¡é‡Œæœ‰å¾ˆå¤šä¹¦',
                        'è€å¸ˆæ•™æˆ‘ä»¬å­¦ä¹ ',
                        'æˆ‘æœ‰ä¸€ä¸ªå¦¹å¦¹',
                        'çˆ¸çˆ¸å¸¦æˆ‘å»å…¬å›­',
                        'æˆ‘å–œæ¬¢ç”»ç”»',
                        'å¤©ä¸Šæœ‰ç™½äº‘',
                        'å°é¸Ÿåœ¨é£',
                        'èŠ±å„¿å¼€äº†å¾ˆç¾ä¸½',
                        'å°è‰ç»¿äº†',
                        'æˆ‘åœ¨å­¦æ ¡å¾ˆå¿«ä¹',
                        'æˆ‘çˆ±æˆ‘çš„è€å¸ˆ',
                        'æˆ‘æœ‰æ–°çš„ä¹¦åŒ…',
                        'ä»Šå¤©æˆ‘å¾ˆå¼€å¿ƒ',
                        'æˆ‘å’ŒåŒå­¦ä¸€èµ·ä¸Šå­¦',
                        'æˆ‘å–œæ¬¢åƒå†°æ·‡æ·‹',
                        'çˆ·çˆ·è®²æ•…äº‹ç»™æˆ‘å¬',
                        'å¥¶å¥¶åšå¥½åƒçš„é¥­èœ',
                        'æˆ‘çš„å°ç‹—å¾ˆå¯çˆ±',
                        'å¦ˆå¦ˆä¹°äº†æ–°è¡£æœ',
                        'æˆ‘åœ¨å®¶é‡Œçœ‹ä¹¦',
                        'æˆ‘å¸®å¦ˆå¦ˆæ‰«åœ°',
                        'çˆ¸çˆ¸æ•™æˆ‘éª‘è‡ªè¡Œè½¦',
                        'æˆ‘æœ‰æ–°çš„ç©å…·',
                        'å­¦æ ¡çš„èŠ±å›­å¾ˆæ¼‚äº®',
                        'æˆ‘å–œæ¬¢ä¸Šè¯­æ–‡è¯¾',
                        // æ–°å¢10å¥
                        // å­£èŠ‚å¤©æ°”
                        'æ˜¥å¤©æ¥äº†èŠ±å„¿å¼€äº†',
                        'å¤å¤©å¾ˆçƒ­å¯ä»¥åƒå†°æ·‡æ·‹',
                        'ç§‹å¤©æ ‘å¶å˜é»„äº†',
                        'å†¬å¤©ä¼šä¸‹é›ªçœŸç¾ä¸½',
                        // å­¦ä¹ ç”Ÿæ´»
                        'æˆ‘ä»Šå¤©å­¦ä¼šäº†æ–°å­—',
                        'æ•°å­¦è¯¾æˆ‘å¾—äº†100åˆ†',
                        'æˆ‘å’ŒåŒæ¡Œä¸€èµ·ç”»ç”»',
                        'æ”¾å­¦è·¯ä¸Šæˆ‘ä¹°é“…ç¬”',
                        // æƒ…æ„Ÿè¡¨è¾¾
                        'æˆ‘é•¿å¤§è¦å½“ç§‘å­¦å®¶',
                        'å¸®åŠ©åˆ«äººæˆ‘å¾ˆå¿«ä¹'
                    ]
                }
            };

                this.init();
            }

            init() {
                this.targetKeyEl = document.getElementById('targetKey');
                this.startBtn = document.getElementById('startBtn');
                this.resetBtn = document.getElementById('resetBtn');
                this.accuracyEl = document.getElementById('accuracy');
                this.correctEl = document.getElementById('correct');
                this.totalEl = document.getElementById('total');

                this.currentWord = '';
                this.currentIndex = 0;
                this.typingMode = false;

                this.bindEvents();
                this.updateDisplay();
            }

            bindEvents() {
                this.startBtn.addEventListener('click', () => this.startGame());
                this.resetBtn.addEventListener('click', () => this.resetGame());
                document.getElementById('slowBtn').addEventListener('click', () => this.setSpeed(2000));
                document.getElementById('normalBtn').addEventListener('click', () => this.setSpeed(1500));
                document.getElementById('fastBtn').addEventListener('click', () => this.setSpeed(1000));

                // é”®ç›˜ç‚¹å‡»äº‹ä»¶
                document.querySelectorAll('.key').forEach(key => {
                    key.addEventListener('click', (e) => {
                        if (this.isPlaying) {
                            this.checkKey(key.dataset.key);
                        }
                    });
                });

                // é”®ç›˜æŒ‰é”®äº‹ä»¶
                document.addEventListener('keydown', (e) => {
                    if (this.isPlaying) {
                        e.preventDefault();
                        this.checkKey(e.key.toLowerCase());
                        this.highlightKey(e.key.toLowerCase());
                    }
                });

                // æ¨¡å¼åˆ‡æ¢
                document.querySelectorAll('.mode-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.switchMode(e.target.dataset.mode);
                    });
                });
            }

            switchMode(mode) {
                this.currentMode = mode;
                document.querySelectorAll('.mode-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector(`[data-mode="${mode}"]`).classList.add('active');
                this.resetGame();
            }

            startGame() {
                this.isPlaying = true;
                this.speed = this.speed || 1500;
                this.generateNewKey();
                this.startBtn.textContent = 'ç»ƒä¹ ä¸­...';
                this.startBtn.disabled = true;
            }

            resetGame() {
                this.isPlaying = false;
                this.correctCount = 0;
                this.totalCount = 0;
                this.currentKey = '';
                this.currentWord = '';
                this.currentIndex = 0;
                this.typingMode = false;
                this.pinyinProgress = '';
                this.currentPinyin = '';
                this.targetKeyEl.textContent = 'æŒ‰<å¼€å§‹ç»ƒä¹ >å¼€å§‹';
                this.targetKeyEl.className = 'target-key';
                this.startBtn.textContent = 'å¼€å§‹ç»ƒä¹ ';
                this.startBtn.disabled = false;
                this.updateDisplay();
                this.clearAllHighlights();
            }

            setSpeed(ms) {
                this.speed = ms;
                // æ›´æ–°æŒ‰é’®æ ·å¼
                document.querySelectorAll('.controls .btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                if (ms === 2000) document.getElementById('slowBtn').classList.add('active');
                if (ms === 1500) document.getElementById('normalBtn').classList.add('active');
                if (ms === 1000) document.getElementById('fastBtn').classList.add('active');
            }

            generateNewKey() {
                if (this.currentMode === 'words' || this.currentMode === 'sentences') {
                    this.typingMode = true;
                    const content = this.modes[this.currentMode].content;
                    this.currentWord = content[Math.floor(Math.random() * content.length)];
                    this.currentIndex = 0;
                    this.displayTypingText();
                } else if (this.currentMode === 'zuowen') {
                    // ä½œæ–‡æ¨¡å¼ç‰¹æ®Šå¤„ç†
                    this.typingMode = true;
                    const content = this.modes[this.currentMode].content;
                    this.currentWord = content[Math.floor(Math.random() * content.length)];
                    this.currentPinyin = getFullPinyin(this.currentWord);
                    this.currentIndex = 0;
                    this.pinyinIndex = 0;
                    this.displayZuowenText();
                } else {
                    this.typingMode = false;
                    const keys = this.modes[this.currentMode].keys;
                    this.currentKey = keys[Math.floor(Math.random() * keys.length)];
                    this.targetKeyEl.textContent = this.currentKey.toUpperCase();
                    this.targetKeyEl.className = 'target-key';
                    
                    // é«˜äº®æ˜¾ç¤ºå¯¹åº”çš„é”®ç›˜æŒ‰é”®
                    this.highlightTargetKey();
                }
            }

            displayTypingText() {
                let displayText = '';
                for (let i = 0; i < this.currentWord.length; i++) {
                    if (i < this.currentIndex) {
                        displayText += `<span style="color: #48bb78;">${this.currentWord[i]}</span>`;
                    } else if (i === this.currentIndex) {
                        displayText += `<span style="color: #e53e3e; font-size: 1.2em;">${this.currentWord[i]}</span>`;
                    } else {
                        displayText += `<span style="color: #2d3748;">${this.currentWord[i]}</span>`;
                    }
                }
                this.targetKeyEl.innerHTML = displayText;
                this.targetKeyEl.className = 'target-key';
                
                // é«˜äº®å½“å‰éœ€è¦è¾“å…¥çš„å­—ç¬¦
                this.highlightTypingKey();
            }

            displayZuowenText() {
                let displayText = '';
                let pinyinDisplay = '';
                
                // æ˜¾ç¤ºä¸­æ–‡å¥å­
                for (let i = 0; i < this.currentWord.length; i++) {
                    if (i < this.currentIndex) {
                        displayText += `<span style="color: #48bb78;">${this.currentWord[i]}</span>`;
                    } else if (i === this.currentIndex) {
                        displayText += `<span style="color: #e53e3e; font-size: 1.2em;">${this.currentWord[i]}</span>`;
                    } else {
                        displayText += `<span style="color: #2d3748;">${this.currentWord[i]}</span>`;
                    }
                }
                
                // æ˜¾ç¤ºæ‹¼éŸ³è¾“å…¥è¿›åº¦
                const currentCharPinyin = pinyinMap[this.currentWord[this.currentIndex]] || '';
                if (currentCharPinyin) {
                    const progress = this.pinyinProgress || '';
                    const remaining = currentCharPinyin.substring(progress.length);
                    pinyinDisplay = `<div style="font-size: 1.2em; color: #666; margin-top: 10px; font-family: monospace;">
                        <span style="color: #48bb78;">${progress}</span>
                        <span style="color: #e53e3e; text-decoration: underline;">${remaining}</span>
                    </div>`;
                }
                
                this.targetKeyEl.innerHTML = displayText + pinyinDisplay;
                this.targetKeyEl.className = 'target-key';
                
                // é«˜äº®å½“å‰éœ€è¦è¾“å…¥çš„å­—ç¬¦
                this.highlightZuowenKey();
            }

            highlightTypingKey() {
                this.clearAllHighlights();
                if (this.currentIndex < this.currentWord.length) {
                    const char = this.currentWord[this.currentIndex].toLowerCase();
                    let key = char;
                    if (char === ' ') key = ' ';
                    const keyEl = document.querySelector(`[data-key="${key}"]`);
                    if (keyEl) {
                        keyEl.classList.add('target');
                    }
                }
            }

            highlightZuowenKey() {
                this.clearAllHighlights();
                if (this.currentIndex < this.currentWord.length) {
                    const pinyin = pinyinMap[this.currentWord[this.currentIndex]] || '';
                    if (pinyin) {
                        const progress = this.pinyinProgress || '';
                        const nextLetter = pinyin[progress.length];
                        if (nextLetter) {
                            const keyEl = document.querySelector(`[data-key="${nextLetter}"]`);
                            if (keyEl) {
                                keyEl.classList.add('target');
                            }
                        }
                    }
                }
            }

            highlightTargetKey() {
                // æ¸…é™¤ä¹‹å‰çš„é«˜äº®
                document.querySelectorAll('.key').forEach(key => {
                    key.classList.remove('target');
                });

                // é«˜äº®å½“å‰ç›®æ ‡æŒ‰é”®
                const keyEl = document.querySelector(`[data-key="${this.currentKey}"]`);
                if (keyEl) {
                    keyEl.classList.add('target');
                }
            }

            checkKey(pressedKey) {
                if (this.typingMode) {
                    this.handleTypingKey(pressedKey);
                } else {
                    this.handleSingleKey(pressedKey);
                }
            }

            handleSingleKey(pressedKey) {
                this.totalCount++;
                
                if (pressedKey === this.currentKey) {
                    this.correctCount++;
                    this.showFeedback('correct');
                } else {
                    this.showFeedback('wrong');
                }

                this.updateDisplay();
                
                if (this.isPlaying) {
                    setTimeout(() => this.generateNewKey(), this.speed || 1500);
                }
            }

            handleTypingKey(pressedKey) {
                if (this.currentIndex >= this.currentWord.length) return;
                
                let expectedChar = this.currentWord[this.currentIndex].toLowerCase();
                
                if (this.currentMode === 'zuowen') {
                    // ä½œæ–‡æ¨¡å¼ï¼šæ˜¾ç¤ºä¸­æ–‡ï¼Œè¾“å…¥å®Œæ•´æ‹¼éŸ³
                    const expectedPinyin = pinyinMap[this.currentWord[this.currentIndex]] || '';
                    
                    // åˆå§‹åŒ–æ‹¼éŸ³è¾“å…¥çŠ¶æ€
                    if (!this.pinyinProgress) {
                        this.pinyinProgress = '';
                        this.currentPinyin = expectedPinyin;
                    }
                    
                    // è·å–å½“å‰æœŸæœ›çš„æ‹¼éŸ³å­—æ¯
                    const expectedNextLetter = this.currentPinyin[this.pinyinProgress.length];
                    
                    if (pressedKey.toLowerCase() === expectedNextLetter) {
                        // æ­£ç¡®æŒ‰é”®ï¼Œç´¯åŠ æ‹¼éŸ³è¿›åº¦
                        this.pinyinProgress += pressedKey.toLowerCase();
                        this.correctCount++;
                        
                        // æ£€æŸ¥æ‹¼éŸ³æ˜¯å¦å®Œæˆ
                        if (this.pinyinProgress === this.currentPinyin) {
                            // å½“å‰æ±‰å­—æ‹¼éŸ³å®Œæˆï¼Œç«‹å³ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªæ±‰å­—ï¼ˆæ— å»¶è¿Ÿï¼‰
                            this.currentIndex++;
                            this.pinyinProgress = '';
                            
                            if (this.currentIndex >= this.currentWord.length) {
                                // å¥å­å®Œæˆï¼Œå¿«é€Ÿè¿›å…¥ä¸‹ä¸€ä¸ª
                                this.showFeedback('correct');
                                setTimeout(() => this.generateNewKey(), 300); // å¿«é€Ÿå»¶è¿Ÿ300ms
                            } else {
                                // ç«‹å³æ˜¾ç¤ºä¸‹ä¸€ä¸ªæ±‰å­—ï¼Œæ— å»¶è¿Ÿ
                                this.displayZuowenText();
                            }
                        } else {
                            // ç»§ç»­è¾“å…¥å½“å‰æ±‰å­—çš„æ‹¼éŸ³ï¼Œæ— å»¶è¿Ÿ
                            this.displayZuowenText();
                        }
                    } else {
                        this.showFeedback('wrong');
                    }
                } else {
                    // ä¼˜åŒ–åçš„å•è¯å’Œå¥å­æ¨¡å¼
                    if (pressedKey === expectedChar || (expectedChar === ' ' && pressedKey === ' ')) {
                        this.correctCount++;
                        this.currentIndex++;
                        
                        if (this.currentIndex >= this.currentWord.length) {
                            // å•è¯/å¥å­å®Œæˆï¼Œå¿«é€Ÿè¿›å…¥ä¸‹ä¸€ä¸ª
                            this.showFeedback('correct');
                            setTimeout(() => this.generateNewKey(), 300); // å¿«é€Ÿå»¶è¿Ÿ300ms
                        } else {
                            // ç«‹å³æ˜¾ç¤ºä¸‹ä¸€ä¸ªå­—ç¬¦ï¼Œæ— å»¶è¿Ÿ
                            this.displayTypingText();
                        }
                    } else {
                        this.showFeedback('wrong');
                    }
                }
                
                this.totalCount++;
                this.updateDisplay();
            }

            showFeedback(type) {
                this.targetKeyEl.classList.add(type);
                
                // é«˜äº®å¯¹åº”çš„é”®ç›˜æŒ‰é”®
                const keyEl = document.querySelector(`[data-key="${this.currentKey}"]`);
                if (keyEl) {
                    keyEl.classList.add(type);
                    setTimeout(() => {
                        keyEl.classList.remove(type);
                    }, 500);
                }

                setTimeout(() => {
                    this.targetKeyEl.classList.remove(type);
                }, 500);
            }

            highlightKey(key) {
                const keyEl = document.querySelector(`[data-key="${key}"]`);
                if (keyEl) {
                    keyEl.classList.add('active');
                    setTimeout(() => {
                        keyEl.classList.remove('active');
                    }, 200);
                }
            }

            clearAllHighlights() {
                document.querySelectorAll('.key').forEach(key => {
                    key.classList.remove('correct', 'wrong', 'active', 'target');
                });
            }

            updateDisplay() {
                const accuracy = this.totalCount > 0 ? Math.round((this.correctCount / this.totalCount) * 100) : 0;
                this.accuracyEl.textContent = accuracy + '%';
                this.correctEl.textContent = this.correctCount;
                this.totalEl.textContent = this.totalCount;
            }
        }

        // å¯åŠ¨æ¸¸æˆ
        const game = new KeyboardGame();
    </script>
</body>
</html>